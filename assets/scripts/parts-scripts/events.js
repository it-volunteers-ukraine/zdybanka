const ajaxUrl=vars.ajaxUrl,sortBtnRef=document.querySelector("#sort-btn"),paginationMoreRef=document.querySelector(".paginate-more"),loadMoreBtnRef=document.querySelector("#load-more"),listElemHtmlRef=document.querySelector("#events-list");let currentPage=Number(listElemHtmlRef.getAttribute("page"));const postsPerPage=Number(listElemHtmlRef.getAttribute("posts-per-page")),postsOffset=postsPerPage*currentPage,eventsQueryParams={posts_per_page:postsPerPage,offset:0,action:"events_more",sort:sortBtnRef.getAttribute("data-sort")};async function sendAjax(e,t){let r=new FormData;if(null!=e)for(const[t,s]of Object.entries(e))r.append(t,s);let s={method:"POST",body:r,redirect:"follow"};const a=await fetch(t,s);return(await a).json()}sortBtnRef.addEventListener("click",(()=>{"desc"===sortBtnRef.getAttribute("data-sort")?sortBtnRef.setAttribute("data-sort","asc"):sortBtnRef.setAttribute("data-sort","desc");let e=eventsQueryParams;e.sort=sortBtnRef.getAttribute("data-sort"),sendAjax(e,ajaxUrl).then((e=>{listElemHtmlRef.innerHTML=e.html}))})),loadMoreBtnRef.addEventListener("click",(e=>{let t=eventsQueryParams;t.offset=currentPage*postsPerPage,sendAjax(t,ajaxUrl).then((e=>{e.posts_count<postsPerPage&&paginationMoreRef.classList.add("hidden"),currentPage+=1,listElemHtmlRef.insertAdjacentHTML("beforeend",e.html),listElemHtmlRef.setAttribute("page",currentPage)}))}));